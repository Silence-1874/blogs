### 事务定义
事务是逻辑上的一组满足**ACID**特性的操作。

### 事务特性
- `Atomicity(原子性)` 事务不可分割，要么全部成功，要么全部失败。

- `Consistency(一致性)` 事务执行的前后保证数据在业务上是合法的，满足一定的完整性约束。

- `Isolation(隔离性)` 一个事务在执行过程中不受其他事务的干扰。

- `Durability(持久性)` 事务提交后，所有的修改都持久保存了下来，即使宕机也不会消失。

### 事务状态
- `Active(活动的)` 事务中的操作正在执行中。

- `Partially Committed(部分提交的)` 最后一个操作执行完，但还没有刷新到磁盘上。

- `Commited(提交的)` 所有操作执行完，并刷新到磁盘上。

- `Failed(失败的)` 遇到错误或人为停止事务。

- `Aborted(中止的)` 事务失败后进行回滚，回滚执行完毕的状态。

![](https://s2.loli.net/2022/07/03/wcu6n52QFilxTWv.png)

### 并发事务问题
假设有并发事务A与事务B。
- `Dirty Write(脏写)` A修改了B中**未提交**事务**修改过**的数据。

- `Dirty Read(脏读)` A读取到了B中**未提交**事务**修改过**的数据，假如B**回滚**，则A的数据是过期的“脏”数据。

- `Non-Repeatable Read(不可重复读)` A以**完全相同的条件**进行两次查询，期间B修改了相关数据，使得A两次查询得到的数据不相同。

- `Phantom(幻读)` A以**完全相同的条件**进行两次查询，期间B**增加或删除**了一些记录，使得A两次查询得到的**记录个数**不同。

### 事务隔离级别
- `READ UNCOMMITTED(读未提交)` 事务可以读取其他事务未提交的数据。

- `READ COMMITTED(读未提交)` 事务只能读取其他事务已提交的事务。

- `REPEATABLE READ(可重复读)` MySQL默认隔离级别。

- `SERIALIZABLE(串行化)` 所有事务串行执行。

|隔离级别|Dirty Read|Non-Repeatable Read|Phantom|
|:-----:|:-:|:-:|:-:|
|READ UNCOMMITTED|未解决|未解决|未解决|
|READ COMMITTED|解决|未解决|未解决|
|REPEATABLE READ|解决|解决|未解决|
|SERIALIZABLE|解决|解决|解决|

> 脏写是很严重的问题，因此任何一种隔离级别都已经解决了脏写问题。

### 参考资料
[[知乎]深入理解数据库事务](https://zhuanlan.zhihu.com/p/43493165)