> 若无特别说明，本系列提到的Java版本均为8，JVM均为HotSpot

### 程序计数器(Program Counter Register)
存储下一条字节码指令的内存空间。

- **线程私有**，生命周期与线程的生命周期一致

- 唯一一个不会出现 **OOM(OutOfMemory)** 的区域

### 虚拟机栈(Virtual Machine Stack)
存储**栈帧(Stack Frame)**，保存**方法调用**信息。

- **线程私有**，生命周期与线程的生命周期一致

- 会出现**StackOverflow**异常和**OOM**异常

#### 局部变量表
存储**方法参数**和**局部变量**。

- 是一个**数组**

- 容量大小在**编译期**就确定，不再改变

- 如果是非静态方法，第0位索引的变量槽存储**this指针**

#### 操作数栈
存储运算的**中间结果**。

- 是一个**栈**

- 容量大小在**编译期**就确定，不再改变

#### 动态连接
指向**运行时常量池**中**该栈帧所属方法**的引用。

#### 方法返回地址
存储方法**正常退出**时**调用该方法**的程序计数器的值。

### 本地方法栈(Native Method Stack)
和虚拟机栈基本一致，但存储的是**本地方法**的相关信息。

《规范》中并没有做太多强制规定，HotSPot中将本地方法栈和虚拟机栈合二为一。

### 堆(Heap)
存储**对象实例**。

- 所有**线程共享**

- **垃圾收集**的主要区域

- **逻辑**上连续，**物理**上可以不连续

- 大小**可扩展**

- 会出现**OOM**异常

### 方法区(Method Area)
存储已被虚拟机加载的**类型信息**(包名、类名、修饰符……)、**方法信息**、**字段信息**、**常量**、**静态变量**、即时编译器编译后的**代码缓存**等数据。

**逻辑上**是堆的一部分。

- 所有**线程共享**

- 可以选择垃圾回收，主要回收目标是**常量池回收**和**类型卸载**

- 会出现**OOM**异常

#### 不同版本的方法区实现
##### JDK1.6
**永久代(Permnent Generation)** 中存放**静态变量**，**StringTable**在**运行时常量池**中

##### JDK1.7
**静态变量**和**StringTable**从永久代移到**堆**，`Class`对象也存储在堆中

##### JDK1.8
永久代改为**元空间(Metaspace)**，存储在**本地内存**中

#### 为什么要将永久代改为元空间
- 永久代有固定大小上限，无法进行调整且难以确定合适的大小；方法区只受限于本地内存的大小，可以动态调整

- JRockit中没有永久代的概念，合并HotSpot和JRockit后，也不需要留了
